<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1,shrink-to-fit=no" name=viewport><meta content=BlahCats name=author><meta content="Tales of a binary encoded life..." name=description><meta prefix="og: http://ogp.me/ns#" content=BlahCats property=og:site_name><meta prefix="og: http://ogp.me/ns#" content=blog property=og:type><meta content="Cheap sandboxing with AppContainers" prefix="og: http://ogp.me/ns#" property=og:title><meta content="Cheap sandboxing with AppContainers - by hugsy" prefix="og: http://ogp.me/ns#" property=og:description><meta prefix="og: http://ogp.me/ns#" content=en_US property=og:locale><meta prefix="og: http://ogp.me/ns#" content=https://blahcat.github.io/2020-12-29-cheap-sandboxing-with-appcontainers property=og:url><meta prefix="og: http://ogp.me/ns#" content=https://blahcat.github.io/img/blog-cover.png property=og:image><meta content=summary_large_image name=twitter:card><meta content=@ctf_blahcat name=twitter:site><meta content=BlahCats name=twitter:title><meta content="Cheap sandboxing with AppContainers - by hugsy" name=twitter:description><meta content=https://blahcat.github.io/2020-12-29-cheap-sandboxing-with-appcontainers name=twitter:url><meta content=https://blahcat.github.io/img/blog-cover.png name=twitter:image:src><script type=application/ld+json>
    {
      "@context" : "http://schema.org",
      "@type" : "Website",
      "name": " BlahCats",
      "url" : "https://blahcat.github.io/2020-12-29-cheap-sandboxing-with-appcontainers",
      
      "image": https://blahcat.github.io/img/blog-cover.png",
      
      
      "description": Cheap sandboxing with AppContainers - by hugsy",
      
    }
    </script><title>
  Cheap sandboxing with AppContainers
</title><link href=https://blahcat.github.io/img/favicon.ico rel=icon type=image/x-icon><link href=https://blahcat.github.io/css/bootstrap.min.css rel=stylesheet><link href=" https://blahcat.github.io/css/all.min.css" rel=" stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Lato" -- <!-- custom for rel=stylesheet styles template this><link href=https://blahcat.github.io/css/clean-blog.css rel=stylesheet><link href=https://blahcat.github.io/css/overrides.css rel=stylesheet><link integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css referrerpolicy=no-referrer rel=stylesheet><body><nav class="navbar navbar-expand-lg navbar-light fixed-top" id=mainNav><div class=container><a class=navbar-brand href=https://blahcat.github.io>BlahCats Blog</a><button aria-label="Toggle navigation" class="navbar-toggler navbar-toggler-right" aria-controls=navbarResponsive aria-expanded=false data-target=#navbarResponsive data-toggle=collapse type=button>Menu <i class="fas fa-bars"></i></button><div class="collapse navbar-collapse" id=navbarResponsive><ul class="navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=https://blahcat.github.io>Home</a><li class=nav-item><a class=nav-link href=https://blahcat.github.io/series>Series</a><li class=nav-item><a class=nav-link href=https://blahcat.github.io/notes>Notes</a><li class=nav-item><a class=nav-link href=https://blahcat.github.io/about>About</a><li class=nav-item><a class=nav-link href=https://blahcat.github.io/qemu>Qemu VMs</a></ul></div></div></nav><header class=masthead style=background-image:url(https://blahcat.github.io/img/blog-cover.png)><div class=overlay></div><div class=container><div class=row><div class="col-lg-8 col-md-10 mx-auto"><div class=post-heading><h1>Cheap sandboxing with AppContainers</h1><span class=meta> <b> ‚Ä¢ <a href=/author/hugsy>hugsy</a> ‚Ä¢ </b> 29 December 2020 <br> <br> <i>Reading time: 7 min</i> </span></div></div></div></div></header><article><article class=post><div class=container><div class=row><div class="col-lg-8 col-md-10 mx-auto"><h2 id=background>Background</h2><p>This is a short blog post that I decided to finish recently after looking for a way to sandbox Win32 apps, but lazy as I am, I wanted something that<ol><li>was free/open-source & robustly tested<li>easily hackable to my need (custom permissions on file/folder/registry, on network access, on device access etc.)<li>little to no modification to my system So off-the-shelf sandboxing products were disregarded immediately because they almost always fail on point #2 and <strong>always</strong> fail on point #1 as they‚Äôll tend to increase attack surface (which is kindda the opposite of the objective here). So quickly Google turned me to <a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/secauthz/appcontainer-isolation target=_blank>Windows AppContainers</a> which the MSDN details the <a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/secauthz/implementing-an-appcontainer target=_blank>implementation</a> well-enough.</ol><p>AppContainers are not new and by the look of it, they are here to stay. They were introduced in Windows 8 as an in-kernel isolation mechanism (a-la seccomp for Linux) and are the default model for UWP applications which a simple look at the new Calculator in Process Hacker shows immediately:</p><a href=/img/4f110a8b-5af4-4f03-8c8d-6fe8e297fffe.png target=_blank> <img alt=image_alt src=/img/4f110a8b-5af4-4f03-8c8d-6fe8e297fffe.png title=image_alt width=100%> </a><p>As the MSDN mentions, AppContainers operates on 6 levels of isolation, each programmatically customizable:<ul><li>The <strong><a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/secauthz/appcontainer-isolation#file-isolation target=_blank>File isolation</a></strong> operates by creating for the AppContained process its own sandbox and named object subtree. This allows the kernel to finely control access to the FS by the contained process.<li>The <strong><a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/secauthz/appcontainer-isolation#network-isolation target=_blank>Network isolation</a></strong> will prevent any communication from/to the process over the network unless explicitly given permissions (and they have relatively explicit names, for instance <code>WinCapabilityInternetClientSid</code> to allow Internet access as a client - see <a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/api/winnt/ne-winnt-well_known_sid_type target=_blank>[WELL_KNOWN_SID_TYPE enumeration]</a>)<li>The <strong><a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/secauthz/appcontainer-isolation#process-isolation target=_blank>Process isolation</a></strong> makes the process unable to get a handle to any process outside the sandbox<li>And <strong><a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/secauthz/appcontainer-isolation#window-isolation target=_blank>Window isolation</a></strong> which makes the process unable to target the Window of other processes.<li>There‚Äôs also <a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/secauthz/appcontainer-isolation#device-isolation target=_blank><strong>Device isolation</strong></a> and <a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/secauthz/appcontainer-isolation#credential-isolation target=_blank><strong>Credential isolation</strong></a> but I haven‚Äôt played too much around those yet‚Ä¶ Maybe a next post‚Ä¶</ul><p>A useful feature added is the DllCharacteristics flag <a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/debug/pe-format#dll-characteristics target=_blank><code>IMAGE_DLLCHARACTERISTICS_APPCONTAINER</code> - 0x1000</a> that will prevent a specific DLL image from being located outside an AppContained environment.<h2 id=appcontainer-where-are-you>AppContainer, where are you?</h2><p>AppContainers being session specific, they are linked to the Session Id: more precisely objects of the container will reside in the <code>\Sessions\&LTSessionId>\AppContainerNamedObjects\&LTAppContainerSid></code><pre class=language-txt data-lang=txt style=color:#c0c5ce;background-color:#2b303b><code class=language-txt data-lang=txt><span>lkd> dx @$cursession.Objects.Children.Where( x => x.Name == "Sessions").First().Children[2].Children
</span><span>@$cursession.Objects.Children.Where( x => x.Name == "Sessions").First().Children[2].Children                 : [object Generator]
</span><span>    [0x0]            : \Sessions\2\AppContainerNamedObjects
</span><span>    [0x1]            : \Sessions\2\Windows
</span><span>    [0x2]            : \Sessions\2\DosDevices
</span><span>    [0x3]            : \Sessions\2\BaseNamedObjects
</span></code></pre><p>As for file/folder objects, they will be located in <code>%LOCALAPPDATA%\Packages\&LTNameOfTheContainer></code>, easily deletable. With each container within the same session being isolated from each other, no real damage can be done outside the sandbox* as everything will be un-done when deleting it (* permissions given depending). So AppContainers was perfect for my case, I just needed a small tool to create AppContainers on-demand - as I couldn‚Äôt find any pre-existing provided by MS.<h2 id=building-an-appcontainer-process>Building an AppContainer Process</h2><br><div class=alert-info markdown=span><b class=markdown-alert-title> <svg class="octicon octicon-info mr-2" viewbox="0 0 16 16" aria-hidden=true height=16 version=1.1 width=16><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.5 7.75A.75.75 0 0 1 7.25 7h1a.75.75 0 0 1 .75.75v2.75h.25a.75.75 0 0 1 0 1.5h-2a.75.75 0 0 1 0-1.5h.25v-2h-.25a.75.75 0 0 1-.75-.75ZM8 6a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"></path></svg> Note </b><p><p>All the snippets below are C/C++ used in my <a rel="noopener nofollow noreferrer" href=https://github.com/hugsy/pwn-- target=_blank><code>pwn++</code></a> library. Refer to the source code for the full implementation. Additionally, as I was already implementing my own version, I stumbled upon <a class="fab fa-twitter" href=https://twitter.com/zodiacon target=_blank> <code>@zodiacon</code> </a> . You might prefer reading/using it if you want a serious implementation.</div><h3 id=create-an-appcontainer-profile>Create an AppContainer profile</h3><p>That‚Äôs as simple as it gets: there‚Äôs an API exactly for that <a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/api/userenv/nf-userenv-createappcontainerprofile target=_blank><code>CreateAppContainerProfile</code></a><pre class=language-c++ data-lang=c++ style=color:#c0c5ce;background-color:#2b303b><code class=language-c++ data-lang=c++><span>PSID AppContainerSid;
</span><span>std::string </span><span style=color:#8fa1b3>ContainerName</span><span>("</span><span style=color:#a3be8c>MyContainer</span><span>");
</span><span>::</span><span style=color:#bf616a>CreateAppContainerProfile</span><span>(
</span><span>    ContainerName.</span><span style=color:#bf616a>c_str</span><span>(),
</span><span>    ContainerName.</span><span style=color:#bf616a>c_str</span><span>(),
</span><span>    ContainerName.</span><span style=color:#bf616a>c_str</span><span>(),
</span><span>    </span><span style=color:#d08770>nullptr</span><span>,
</span><span>    </span><span style=color:#d08770>0</span><span>,
</span><span>    &AppContainerSid
</span><span>);
</span></code></pre><h3 id=add-the-desired-capabilities>Add the desired capabilities</h3><p>This was slightly trickier: to expose a specific capability or file/folder access to the container we must rely on <a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/secauthz/modifying-the-acls-of-an-object-in-c-- target=_blank>Windows object ACL mechanism</a>.<pre class=language-c++ data-lang=c++ style=color:#c0c5ce;background-color:#2b303b><code class=language-c++ data-lang=c++><span>    </span><span style=color:#65737e>// Saved the old ACL - you don't want to skip this step üòâ
</span><span>    ::</span><span style=color:#bf616a>GetNamedSecurityInfo</span><span>(ObjectName, ObjectType, DACL_SECURITY_INFORMATION, </span><span style=color:#d08770>nullptr</span><span>, </span><span style=color:#d08770>nullptr</span><span>, &pOldAcl, </span><span style=color:#d08770>nullptr</span><span>, &pSD);
</span><span>
</span><span>    </span><span style=color:#65737e>// Add the new access mode & mask entry
</span><span>    Access.</span><span style=color:#bf616a>grfAccessMode </span><span>= AccessMode;
</span><span>    Access.</span><span style=color:#bf616a>grfAccessPermissions </span><span>= AccessMask;
</span><span>    Access.</span><span style=color:#bf616a>grfInheritance </span><span>= OBJECT_INHERIT_ACE | CONTAINER_INHERIT_ACE;
</span><span>    Access.</span><span style=color:#bf616a>Trustee</span><span>.</span><span style=color:#bf616a>MultipleTrusteeOperation </span><span>= NO_MULTIPLE_TRUSTEE;
</span><span>    Access.</span><span style=color:#bf616a>Trustee</span><span>.</span><span style=color:#bf616a>pMultipleTrustee </span><span>= </span><span style=color:#d08770>nullptr</span><span>;
</span><span>    Access.</span><span style=color:#bf616a>Trustee</span><span>.</span><span style=color:#bf616a>ptstrName </span><span>= (PWSTR)AppContainerSid.</span><span style=color:#bf616a>c_str</span><span>();
</span><span>    Access.</span><span style=color:#bf616a>Trustee</span><span>.</span><span style=color:#bf616a>TrusteeForm </span><span>= TRUSTEE_IS_SID;
</span><span>    Access.</span><span style=color:#bf616a>Trustee</span><span>.</span><span style=color:#bf616a>TrusteeType </span><span>= TRUSTEE_IS_GROUP;
</span><span>    ::</span><span style=color:#bf616a>SetEntriesInAcl</span><span>(</span><span style=color:#d08770>1</span><span>, &Access, pOldAcl, &pNewAcl);
</span><span>
</span><span>    </span><span style=color:#65737e>// Apply the new ACLs
</span><span>    ::</span><span style=color:#bf616a>SetNamedSecurityInfo</span><span>(ObjectName, ObjectType, DACL_SECURITY_INFORMATION, </span><span style=color:#d08770>nullptr</span><span>, </span><span style=color:#d08770>nullptr</span><span>, pNewAcl, </span><span style=color:#d08770>nullptr</span><span>);
</span></code></pre><h3 id=insert-the-capability-set-to-the-startup-info>Insert the capability set to the startup info</h3><p>Not unlike <a rel="noopener nofollow noreferrer" href=https://github.com/hugsy/pwn--/tree/main/Tools/Win32/ProcessReparent target=_blank>process reparenting</a>, appcontainerization requires to define a set of attribute as part of the extended startup information structure:<pre class=language-c++ data-lang=c++ style=color:#c0c5ce;background-color:#2b303b><code class=language-c++ data-lang=c++><span>    SIZE_T size;
</span><span>    </span><span style=color:#bf616a>m_StartupInfo</span><span>.</span><span style=color:#bf616a>StartupInfo</span><span>.</span><span style=color:#bf616a>cb </span><span>= sizeof(STARTUPINFOEX);
</span><span>    ::</span><span style=color:#bf616a>InitializeProcThreadAttributeList</span><span>(</span><span style=color:#d08770>nullptr</span><span>, </span><span style=color:#d08770>1</span><span>, </span><span style=color:#d08770>0</span><span>, &size);
</span><span>    StartupInfo.</span><span style=color:#bf616a>lpAttributeList </span><span>= (LPPROC_THREAD_ATTRIBUTE_LIST)::new byte[size];
</span><span>    ::</span><span style=color:#bf616a>InitializeProcThreadAttributeList</span><span>(StartupInfo.</span><span style=color:#bf616a>lpAttributeList</span><span>, </span><span style=color:#d08770>1</span><span>, </span><span style=color:#d08770>0</span><span>, &size);
</span><span>    ::</span><span style=color:#bf616a>UpdateProcThreadAttribute</span><span>(StartupInfo.</span><span style=color:#bf616a>lpAttributeList</span><span>, </span><span style=color:#d08770>0</span><span>, PROC_THREAD_ATTRIBUTE_SECURITY_CAPABILITIES, &SecurityCapabilities, sizeof(SecurityCapabilities), </span><span style=color:#d08770>nullptr</span><span>, </span><span style=color:#d08770>nullptr</span><span>);
</span></code></pre><h3 id=start-the-process>Start the process</h3><p>All that‚Äôs left now, is simply to invoke <a rel="noopener nofollow noreferrer" href=https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa target=_blank><code>CreateProcess</code></a> and we get the AppContained process.<pre class=language-c++ data-lang=c++ style=color:#c0c5ce;background-color:#2b303b><code class=language-c++ data-lang=c++><span>    ::</span><span style=color:#bf616a>CreateProcessW</span><span>(
</span><span>        </span><span style=color:#d08770>nullptr</span><span>,
</span><span>        (LPWSTR)lpwCmdLine.</span><span style=color:#bf616a>get</span><span>(),
</span><span>        </span><span style=color:#d08770>nullptr</span><span>,
</span><span>        </span><span style=color:#d08770>nullptr</span><span>,
</span><span>        </span><span style=color:#d08770>false</span><span>,
</span><span>        EXTENDED_STARTUPINFO_PRESENT,
</span><span>        </span><span style=color:#d08770>nullptr</span><span>,
</span><span>        </span><span style=color:#d08770>nullptr</span><span>,
</span><span>        (LPSTARTUPINFO)&StartupInfo,
</span><span>        &ProcessInfo
</span><span>    );
</span></code></pre><p>Surprisingly not hard to implement in C/C++ (and by extension also in C#), I‚Äôm surprised to see this rather efficient sandbox mechanism not being more broader to encapsulate legacy Win32 apps which functionally require only a small set of permissions available.<h2 id=result>Result</h2><p>The <del>complete</del> functional command line tool AppContainMe<a href=https://blahcat.github.io/2020-12-29-cheap-sandboxing-with-appcontainers/#ref_3>[3]</a> that uses the AppContainer implementation allows to launch contained process:<pre class=language-txt data-lang=txt style=color:#c0c5ce;background-color:#2b303b><code class=language-txt data-lang=txt><span>PS> d:\code\pwn++\x64\release\appcontainme.exe
</span><span>[-]  syntax
</span><span>        appcontainme.exe 'process_to_run.exe arg1 arg2' [d:\allowed\path1 d:\allowed\path2] [c:Capability1 c:Capability2] [r:regkey1 r:regkey2]
</span></code></pre><p>It‚Äôs not complete but does the trick for me: without any option, the process will be spawn without any access to the FS (except the subtree allocated to the container in LocalAppData), no network access, no capability etc. So for example, we can start a totally harmless <code>powershell</code> session and obverse the process runs without any privilege (<code>powershell</code> cannot even get to our home directory).<pre class=language-powershell data-lang=powershell style=color:#c0c5ce;background-color:#2b303b><code class=language-powershell data-lang=powershell><span>PS> AppContainMe powershell
</span></code></pre><a href=/img/29d17988-bf1f-4a1c-8b63-b01e97e6b53f.png target=_blank> <img alt=image_alt src=/img/29d17988-bf1f-4a1c-8b63-b01e97e6b53f.png title=image_alt width=100%> </a><p>It won‚Äôt also have any network access:<pre class=language-txt data-lang=txt style=color:#c0c5ce;background-color:#2b303b><code class=language-txt data-lang=txt><span>PS C:\WINDOWS\System32\WindowsPowerShell\v1.0> Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('http://google.com'))
</span><span>
</span><span>Exception calling "DownloadString" with "1" argument(s): "The remote name could not be resolved:
</span><span>'google.com'"
</span><span>At line:1 char:1
</span><span>+ Invoke-Expression ((New-Object System.Net.WebClient).DownloadString(' ...
</span><span>+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</span><span>+ CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
</span><span>+ FullyQualifiedErrorId : WebException
</span></code></pre><p>Or process listing:<pre class=language-txt data-lang=txt style=color:#c0c5ce;background-color:#2b303b><code class=language-txt data-lang=txt><span>PS C:\WINDOWS\System32\WindowsPowerShell\v1.0> ps
</span><span>
</span><span>Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
</span><span>      0       0       60          8                 0   0 Idle
</span><span>    705      32    79932      92600       0.73   7676   2 powershell
</span></code></pre><p>So that confirms all the ‚Äúisolation‚Äù points that are stated in the MSDN. It also works perfectly well for Win32 GUI apps, for PDF Readers <a href=/img/1e3a7b9c-7ef6-481d-a803-d0a969b3eab4.png target=_blank> <img alt="PDF Reader" title="PDF Reader" src=/img/1e3a7b9c-7ef6-481d-a803-d0a969b3eab4.png width=100%> </a><p>Also, for having lightweight web browsing sessions (like with <a rel="noopener nofollow noreferrer" href=http://www.qtweb.net/ target=_blank><code>qtweb.exe</code></a>) <a href=/img/283fd853-c2c7-4846-9b7c-242bfe1b02a1.png target=_blank> <img alt="Web browser" title="Web browser" src=/img/283fd853-c2c7-4846-9b7c-242bfe1b02a1.png width=100%> </a><p>That‚Äôs pretty much it for this small post about AppContainers. If you want to play out-of-the-box with <code>AppContainMe</code>, a release archive with all the files is <a rel="noopener nofollow noreferrer" href=https://github.com/hugsy/pwn--/releases target=_blank>here</a>.<h2 id=credits-links>Credits & Links</h2><p>Shout out to Pavel Yosivovich for his article and tool on AppContainer. And credits to COVID lockdown for giving me time to get back to finishing writing articles. More to come üòâ‚Ä¶<ul><li><a name=ref_1>[1]</a> <a rel="noopener nofollow noreferrer" href=https://scorpiosoftware.net/2019/01/15/fun-with-appcontainers/ target=_blank>Fun with AppContainers</a><li><a name=ref_2>[2]</a> <a rel="noopener nofollow noreferrer" href=https://github.com/zodiacon/RunAppContainer target=_blank>zodiacon/RunAppContainer - Github</a><li><a name=ref_3>[3]</a> <a rel="noopener nofollow noreferrer" href=https://github.com/hugsy/pwn--/tree/main/Tools/Win32/AppContainMe target=_blank>hugsy/pwn++ - Github</a></ul><p>Peace ‚úå<aside class=post-tags><p>Categories: <a href=https://blahcat.github.io/categories/research/>#research</a><p>Tags: <a href=https://blahcat.github.io/tags/windows/>#windows</a> <a href=https://blahcat.github.io/tags/sandbox/>#sandbox</a> <a href=https://blahcat.github.io/tags/appcontainer/>#appcontainer</a></aside><aside class=post-discussion>Join the Discussion on <a href="https://github.com/blahcat/blahcat.github.io/discussions?discussions_q=Cheap sandboxing with AppContainers" target=_blank> <i class="fab fa-github fa-lg"></i>¬†GitHub </a></aside><aside class=post-nav><div class=container><div class=row><div class=col><b>Next:</b><br><a class=post-nav-prev href=https://blahcat.github.io/2021-01-10-browsing-registry-kernel-mode/> <section class=post-nav-teaser><b class=post-nav-title>Browsing the registry in kernel-mode</b><p class=post-nav-excerpt>One of Windows kernel subsystem I recently dug into is the Configuration Ma‚Ä¶</section> </a></div><div class=col><b>Previous:</b><br><a class=post-nav-next href=https://blahcat.github.io/2020-06-15-playing-with-self-reference-pml4-entry/> <section class=post-nav-teaser><b class=post-nav-title>Some toying with the Self-Reference PML4 Entry</b><p class=post-nav-excerpt>Sometimes you read about an awesome exploitation technique (#1), so you wan‚Ä¶</section> </a></div></div></div></aside></div></div><hr><footer><div class=container><div class=row><div class="col-lg-8 col-md-10 mx-auto"><ul class="list-inline text-center"><li class=list-inline-item><a href=https://blahcat.github.io/atom.xml> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fas fa-rss fa-stack-1x fa-inverse"></i> </span> </a><li class=list-inline-item><a href=https://twitter.com/ctf_blahcat> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-twitter fa-stack-1x fa-inverse"></i> </span> </a><li class=list-inline-item><a href=https://github.com/blahcat> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-github fa-stack-1x fa-inverse"></i> </span> </a><li class=list-inline-item><a href=https://www.youtube.com/channel/UCDrgY65mRZWVoMiB5-VMqfg> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-youtube fa-stack-1x fa-inverse"></i> </span> </a><li class=list-inline-item><a href=https://discord.gg/hSbqxxBgRX> <span class="fa-stack fa-lg"> <i class="fas fa-circle fa-stack-2x"></i> <i class="fab fa-discord fa-stack-1x fa-inverse"></i> </span> </a></ul><p class="copyright text-muted">Made with ‚ù§ with Zola</div></div></div></footer><script src=https://blahcat.github.io/js/jquery.min.js></script><script src=https://blahcat.github.io/js/bootstrap.bundle.min.js></script><script src=https://blahcat.github.io/js/clean-blog.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/mermaid/9.1.1/mermaid.min.js></script><div class=mermaidTooltip style=opacity:0></div>